<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë§ˆìŒ ì»¨ë””ì…˜ ì²´í¬ Â· ê¸°ìš´ íšŒë³µ ê°€ì´ë“œ</title>
  <meta name="description" content="ì§„ë‹¨ì´ ì•„ë‹Œ, ì˜¤ëŠ˜ì˜ ë§ˆìŒì„ ì •ë¦¬í•˜ê³  ê¸°ìš´ì„ íšŒë³µí•˜ëŠ” ì§§ì€ ì²´í¬ì™€ ì‘ì›." />
  
  <!-- OG -->
  <meta property="og:title" content="ë§ˆìŒ ì»¨ë””ì…˜ ì²´í¬ Â· ê¸°ìš´ íšŒë³µ ê°€ì´ë“œ" />
  <meta property="og:description" content="ì§„ë‹¨ì´ ì•„ë‹Œ, ì˜¤ëŠ˜ì˜ ë§ˆìŒì„ ì •ë¦¬í•˜ê³  ê¸°ìš´ì„ íšŒë³µí•˜ëŠ” ì§§ì€ ì²´í¬ì™€ ì‘ì›." />
  <meta property="og:image" content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Mind+Condition+Check" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://melancholy.funnyfunny.cloud/" />
  
  <!-- Favicon (SVG) -->
  <link rel="icon" href="data:image/svg+xml,
  <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
    <rect width='100' height='100' rx='20' fill='%230b1220'/>
    <text x='50' y='62' font-size='52' text-anchor='middle' fill='white'>ğŸŒ™</text>
  </svg>">
  <style>
    :root{
      --bg1:#fff8f8;
      --bg2:#f3f0ff;
      --card:#ffffffcc;
      --text:#1b1b1f;
      --muted:#666671;
      --line:#e9e7f3;
      --accent:#6b6eff;
      --accent2:#f4c2c2;
      --shadow: 0 16px 60px rgba(20, 20, 40, .10);
      --r: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 15% 10%, rgba(244,194,194,.55), transparent 60%),
        radial-gradient(900px 520px at 85% 15%, rgba(107,110,255,.22), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      overflow-x:hidden;
    }
    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 28px 18px 80px;
    }
    header{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    .brand{
      display:flex; flex-direction:column; gap:8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.55);
      border-radius: 999px;
      color:var(--muted);
      font-size:12px;
      width: fit-content;
      backdrop-filter: blur(10px);
    }
    h1{
      margin:0;
      font-size: 22px;
      letter-spacing: -0.3px;
      line-height: 1.25;
    }
    .sub{
      color:var(--muted);
      font-size: 14px;
      line-height: 1.55;
      margin-top: 4px;
      max-width: 64ch;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
      align-items:start;
    }
    @media (max-width: 860px){
      .grid{grid-template-columns: 1fr; }
    }
    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(14px);
    }
    .card h2{
      margin: 0 0 10px;
      font-size: 16px;
      letter-spacing: -0.2px;
    }
    .card p{
      margin: 8px 0 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.6;
    }
    .btnRow{display:flex; flex-wrap:wrap; gap:10px; margin-top:14px;}
    button{
      appearance:none;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.7);
      color: var(--text);
      border-radius: 16px;
      padding: 12px 14px;
      cursor:pointer;
      transition: transform .08s ease, background .2s ease, border-color .2s ease;
      font-weight: 650;
      letter-spacing: -0.1px;
    }
    button:hover{ transform: translateY(-1px); border-color: rgba(107,110,255,.35); }
    button.primary{
      background: linear-gradient(135deg, rgba(107,110,255,.18), rgba(244,194,194,.28));
      border-color: rgba(107,110,255,.25);
    }
    button.ghost{
      background: rgba(255,255,255,.45);
      font-weight: 600;
      color: var(--muted);
    }
    .stepTitle{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin-bottom: 10px;
    }
    .progress{
      color: var(--muted);
      font-size: 12px;
      border:1px solid var(--line);
      border-radius: 999px;
      padding: 6px 10px;
      background: rgba(255,255,255,.55);
    }
    .q{
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px dashed rgba(107,110,255,.18);
    }
    .q h3{
      margin: 0 0 10px;
      font-size: 15px;
      letter-spacing: -0.2px;
    }
    .choices{display:grid; gap:10px; }
    .choice{
      display:flex; align-items:flex-start; gap:10px;
      padding: 12px 12px;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.62);
      cursor:pointer;
      transition: border-color .2s ease, transform .08s ease;
      user-select:none;
    }
    .choice:hover{ transform: translateY(-1px); border-color: rgba(107,110,255,.30); }
    .choice input{ margin-top:3px; }
    .choice small{ color: var(--muted); display:block; margin-top:4px; line-height: 1.4; }
    .rightCol .mini{
      border: 1px solid var(--line);
      border-radius: var(--r);
      padding: 14px;
      background: rgba(255,255,255,.55);
    }
    .mini h3{ margin:0 0 6px; font-size: 14px; }
    .mini p{ margin:0; color: var(--muted); font-size: 13px; line-height: 1.55; }
    .tagRow{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
    .tag{
      font-size: 12px;
      color: var(--muted);
      border:1px solid var(--line);
      background: rgba(255,255,255,.55);
      padding: 6px 10px;
      border-radius: 999px;
    }
    .result{
      display:none;
      margin-top: 14px;
      animation: fadeUp .22s ease both;
    }
    .result.show{ display:block; }
    @keyframes fadeUp{
      from{opacity:0; transform: translateY(8px);}
      to{opacity:1; transform: translateY(0);}
    }
    .resultGrid{
      display:grid; gap:12px;
      grid-template-columns: 1fr;
      margin-top: 8px;
    }
    .kicker{ color: var(--accent); font-weight: 750; font-size: 12px; }
    .bigMsg{
      font-size: 18px;
      line-height: 1.5;
      letter-spacing: -0.25px;
      margin: 8px 0 0;
    }
    .muted{ color: var(--muted); font-size: 14px; line-height: 1.65; }
    .needList{ display:grid; gap:10px; margin-top: 10px; }
    .needItem{
      display:flex; gap:10px; align-items:flex-start;
      padding: 12px;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.62);
      cursor:pointer;
      user-select:none;
    }
    .needItem input{ margin-top:3px; }
    .actions{
      display:grid; gap:10px;
      margin-top: 10px;
    }
    .act{
      padding: 12px;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.62);
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .act span{ font-weight: 700; letter-spacing:-0.1px; }
    .copyBox{
      margin-top: 10px;
      padding: 12px;
      border:1px solid var(--line);
      border-radius: 16px;
      background: rgba(255,255,255,.62);
    }
    .quote{
      font-size: 16px;
      line-height: 1.6;
      letter-spacing: -0.2px;
      margin: 0;
    }
    .copyBtns{ display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px; }
    .footerNote{
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.55;
    }

    /* â€œì²´í¬í• ìˆ˜ë¡ ë°°ê²½ì´ ë°ì•„ì§€ëŠ”â€ íš¨ê³¼ */
    .glow0{ background: rgba(255,255,255,.55); }
    .glow1{ background: rgba(255,255,255,.62); }
    .glow2{ background: rgba(255,255,255,.70); }
    .glow3{ background: rgba(255,255,255,.78); }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="pill">ğŸŒ™ ì§„ë‹¨ì´ ì•„ë‹Œ, ì˜¤ëŠ˜ì˜ ë§ˆìŒ ì •ë¦¬</div>
        <h1>ë§ˆìŒ ì»¨ë””ì…˜ ì²´í¬ Â· ê¸°ìš´ íšŒë³µ ê°€ì´ë“œ</h1>
        <div class="sub">
          ì§§ì€ ì§ˆë¬¸ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ ìƒíƒœë¥¼ ì •ë¦¬í•˜ê³ , ì§€ê¸ˆ ê°€ëŠ¥í•œ í–‰ë™ 3ê°€ì§€ì™€ ì‘ì› ë¬¸ì¥ì„ ë“œë ¤ìš”.
          (ì˜ë£Œ ì§„ë‹¨/ì¹˜ë£Œ ëª©ì ì´ ì•„ë‹™ë‹ˆë‹¤)
        </div>
      </div>
      <div class="pill" id="sessionInfo">ì„¸ì…˜: ì¤€ë¹„ì¤‘</div>
    </header>

    <div class="grid">
      <!-- Main -->
      <section class="card" id="mainCard">
        <div class="stepTitle">
          <h2 id="stepH2">ì‹œì‘</h2>
          <div class="progress" id="progress">0 / 3</div>
        </div>

        <!-- Step 0 -->
        <div id="step0">
          <p style="margin-top:0">ì˜¤ëŠ˜ì€ ì–´ë–¤ ìª½ì´ ë” ê°€ê¹Œì›Œìš”?</p>
          <div class="btnRow">
            <button class="primary" onclick="startFlow('mood')">ğŸŒ™ ê·¸ëƒ¥ ì¢€ ìš°ìš¸í•´ìš”</button>
            <button class="primary" onclick="startFlow('pms')">ğŸŒ¸ ìƒë¦¬ ì „ì´ë¼ ë” í˜ë“¤ì–´ìš”</button>
          </div>
          <p class="footerNote">â€» â€œìƒë¦¬ ì „â€ ì„ íƒì€ ì—¬ì„±/ì£¼ê¸° ê´€ë ¨ ì§ˆë¬¸ì´ ë¨¼ì € ë‚˜ì™€ìš”. ì„±ë³„ì€ ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì„ íƒí•  ìˆ˜ ìˆì–´ìš”.</p>
        </div>

        <!-- Step 1 -->
        <div id="step1" style="display:none">
          <div class="q">
            <h3>Q1. ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
            <div class="choices">
              <label class="choice"><input type="radio" name="gender" value="female"> ë‚˜ëŠ” ì—¬ì„±</label>
              <label class="choice"><input type="radio" name="gender" value="male"> ë‚˜ëŠ” ë‚¨ì„±</label>
              <label class="choice"><input type="radio" name="gender" value="na"> ë§í•˜ê³  ì‹¶ì§€ ì•Šì•„ìš”</label>
            </div>
          </div>

          <div class="btnRow">
            <button class="ghost" onclick="goBack()">â† ë’¤ë¡œ</button>
            <button class="primary" onclick="toStep2()">ë‹¤ìŒ â†’</button>
          </div>
        </div>

        <!-- Step 2 -->
        <div id="step2" style="display:none">
          <div class="q">
            <h3>Q2. ìµœê·¼ 3ì¼ ê¸°ì¤€ìœ¼ë¡œ ê°€ê¹Œìš´ ê²ƒë“¤ì„ ê³¨ë¼ì£¼ì„¸ìš” (ë³µìˆ˜ ì„ íƒ)</h3>
            <div class="choices" id="symptomChoices"></div>
          </div>

          <div class="q" id="pmsBlock" style="display:none">
            <h3>Q3. (ì„ íƒ) ìƒë¦¬ ì‹œì‘ì´ ê°€ê¹Œìš´ê°€ìš”?</h3>
            <div class="choices">
              <label class="choice"><input type="radio" name="cycle" value="7"> 1ì£¼ ì´ë‚´</label>
              <label class="choice"><input type="radio" name="cycle" value="14"> 2ì£¼ ì´ë‚´</label>
              <label class="choice"><input type="radio" name="cycle" value="0"> ì˜ ëª¨ë¥´ê² ì–´ìš”</label>
            </div>
            <p class="footerNote">â€» â€œì˜ ëª¨ë¥´ê² ì–´ìš”â€ë¥¼ ì„ íƒí•´ë„ ê´œì°®ì•„ìš”.</p>
          </div>

          <div class="q">
            <h3>Q4. ìš”ì¦˜ ìˆ˜ë©´ì€ ì–´ë–¤ í¸ì¸ê°€ìš”?</h3>
            <div class="choices">
              <label class="choice"><input type="radio" name="sleep" value="1"> ë§ì´ ì”ë‹¤ / ìê¾¸ ì¡¸ë¦¬ë‹¤</label>
              <label class="choice"><input type="radio" name="sleep" value="2"> ì ì´ ì¤„ì—ˆë‹¤ / ë’¤ì²™ì¸ë‹¤</label>
              <label class="choice"><input type="radio" name="sleep" value="0"> ë¹„ìŠ·í•˜ë‹¤</label>
            </div>
          </div>

          <div class="q">
            <h3>Q5. ë‹¹ì´ ë‹¹ê¸°ê±°ë‚˜ í­ì‹ì´ ìˆì—ˆë‚˜ìš”?</h3>
            <div class="choices">
              <label class="choice"><input type="radio" name="crave" value="2"> ìì£¼ ìˆì—ˆë‹¤</label>
              <label class="choice"><input type="radio" name="crave" value="1"> ê°€ë” ìˆì—ˆë‹¤</label>
              <label class="choice"><input type="radio" name="crave" value="0"> ê±°ì˜ ì—†ë‹¤</label>
            </div>
          </div>

          <div class="btnRow">
            <button class="ghost" onclick="goBack()">â† ë’¤ë¡œ</button>
            <button class="primary" onclick="showResult()">ê²°ê³¼ ë³´ê¸°</button>
          </div>
        </div>

        <!-- Result -->
        <div class="result" id="result">
          <div class="resultGrid">
            <div class="card glow0" id="cardInterpret">
              <div class="kicker">í•´ì„</div>
              <div class="bigMsg" id="interpretTitle"></div>
              <div class="muted" id="interpretBody"></div>
            </div>

            <div class="card glow0" id="cardNeeds">
              <div class="kicker">ì˜¤ëŠ˜ ë‚˜ì—ê²Œ í•„ìš”í•œ ê²ƒ</div>
              <div class="muted">ì²´í¬í• ìˆ˜ë¡ í™”ë©´ì´ ì¡°ê¸ˆ ë” ë°ì•„ì ¸ìš”. ì˜¤ëŠ˜ì€ â€œí—ˆë½â€ì„ ì£¼ëŠ” ê²Œ ëª©í‘œì˜ˆìš”.</div>
              <div class="needList" id="needList"></div>
            </div>

            <div class="card glow0" id="cardActions">
              <div class="kicker">ì§€ê¸ˆ ê°€ëŠ¥í•œ í–‰ë™ 3ê°€ì§€</div>
              <div class="muted">ê±°ì°½í•œ ëª©í‘œ ë§ê³ , ì˜¤ëŠ˜ ê°€ëŠ¥í•œ ìµœì†Œ ë‹¨ìœ„ë¡œë§Œ ì¶”ì²œí•´ìš”.</div>
              <div class="actions" id="actionsList"></div>
            </div>

            <div class="card glow0" id="cardQuote">
              <div class="kicker">ì˜¤ëŠ˜ì˜ ë¬¸ì¥</div>
              <div class="copyBox">
                <p class="quote" id="quoteText">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¬¸ì¥ì´ ë‚˜ì™€ìš”.</p>
                <div class="copyBtns">
                  <button class="primary" onclick="genQuote()">ğŸ’Œ ì˜¤ëŠ˜ì˜ ë¬¸ì¥ ë°›ê¸°</button>
                  <button onclick="copyQuote()">ğŸ“‹ ë³µì‚¬</button>
                  <button class="ghost" onclick="restart()">â†» ë‹¤ì‹œí•˜ê¸°</button>
                </div>
              </div>
              <div class="footerNote" id="supportNote"></div>
            </div>

            <div class="card glow0" id="cardPartner" style="display:none">
              <div class="kicker">ì£¼ë³€ì¸ì—ê²Œ ë³´ì—¬ì£¼ê¸°</div>
              <div class="bigMsg">â€œí•´ê²°â€ ë§ê³  â€œê³µê°â€ì´ ê°€ì¥ ë„ì›€ì´ ë¼ìš”.</div>
              <div class="muted" id="partnerText"></div>
              <div class="copyBtns">
                <button onclick="copyPartner()">ğŸ“‹ ì´ ë¬¸ì¥ë“¤ ë³µì‚¬</button>
              </div>
            </div>

            <div class="footerNote">
              â€» ì´ ì„œë¹„ìŠ¤ëŠ” ì˜ë£Œ ì§„ë‹¨/ì¹˜ë£Œ ëª©ì ì´ ì•„ë‹™ë‹ˆë‹¤. <br/>
              ë§Œì•½ ë§¤ë‹¬ ë°˜ë³µë˜ê³  ì¼ìƒì— í° ì§€ì¥ì´ ìˆê±°ë‚˜, ìì‹ ì´ ë„ˆë¬´ í˜ë“¤ë‹¤ëŠ” ìƒê°ì´ ê°•í•´ì§„ë‹¤ë©´
              ì‚°ë¶€ì¸ê³¼/ì •ì‹ ê±´ê°•ì˜í•™ê³¼ ìƒë‹´ì´ í° ë„ì›€ì´ ë  ìˆ˜ ìˆì–´ìš”.
            </div>
          </div>
        </div>
      </section>

      <!-- Side -->
      <aside class="rightCol">
        <div class="mini">
          <h3>ì˜¤ëŠ˜ì˜ ì›ì¹™</h3>
          <p>ë…¼ë¦¬ë¡œ í•´ê²°í•˜ë ¤ í•˜ê¸°ë³´ë‹¤, ì§€ê¸ˆì˜ ê°ì •ì„ â€œì •ë¦¬â€í•˜ëŠ” ê²Œ ëª©í‘œì˜ˆìš”.</p>
          <div class="tagRow">
            <span class="tag">ê³µê°</span>
            <span class="tag">ìê¸°ë¹„ë‚œ ì¤„ì´ê¸°</span>
            <span class="tag">ìµœì†Œ í–‰ë™ 3ê°œ</span>
            <span class="tag">ë³µì‚¬ ê°€ëŠ¥í•œ ë¬¸ì¥</span>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="mini">
          <h3>ë°ì´í„° ì €ì¥</h3>
          <p>ì´ ìƒ˜í”Œì€ ë¸Œë¼ìš°ì €ì—ì„œë§Œ ë™ì‘í•˜ë©° ì„œë²„ ì „ì†¡ì„ í•˜ì§€ ì•Šì•„ìš”. (ì›í•˜ë©´ localStorage ì €ì¥ë„ ë¶™ì¼ ìˆ˜ ìˆì–´ìš”)</p>
        </div>

        <div style="height:12px"></div>

        <div class="mini">
          <h3>ì¶”ì²œ ê¸°ëŠ¥ í™•ì¥</h3>
          <p>ì£¼ê¸° ìº˜ë¦°ë” / ì•Œë¦¼ / ê°ì • ë¡œê·¸ / "ì˜¤ëŠ˜ì€ ì—°ë½ ì¤„ì—¬ë„ ë˜ëŠ” ë‚ " ë°°ì§€ ë“±ìœ¼ë¡œ í™•ì¥í•˜ê¸° ì¢‹ì•„ìš”.</p>
        </div>

        <div style="height:12px"></div>

        <!-- Other Services -->
        <div class="mini">
          <h3>ë‹¤ë¥¸ ì„œë¹„ìŠ¤</h3>
          <p>funnyfunny.cloudì—ì„œ ë” ë§ì€ ì„œë¹„ìŠ¤ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
          <div style="margin-top:10px;">
            <a href="https://funnyfunny.cloud" target="_blank" rel="noopener" style="text-decoration:none;">
              <button class="primary" style="width:100%;">âœ¨ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</button>
            </a>
          </div>
        </div>
      </aside>
    </div>
  </div>

<script>
  // -----------------------------
  // State
  // -----------------------------
  const state = {
    flow: null,        // 'mood' | 'pms'
    gender: null,      // 'female' | 'male' | 'na'
    symptoms: new Set(),
    cycle: null,       // 7 | 14 | 0 | null
    sleep: null,       // 0 | 1 | 2
    crave: null,       // 0 | 1 | 2
    score: 0,
    severity: 'low'    // low | mid | high
  };

  const steps = ['step0','step1','step2'];
  let currentStep = 0;

  // ì§ˆë¬¸ ë¬¸í•­(ë³µìˆ˜ì„ íƒ) + ê°€ì¤‘ì¹˜
  const SYMPTOMS = [
    { id:'sad', label:'ì´ìœ  ì—†ì´ ìŠ¬í””/ê³µí—ˆê°ì´ ì˜¬ë¼ì˜¨ë‹¤', w:2 },
    { id:'irrit', label:'í‰ì†Œë³´ë‹¤ ì˜ˆë¯¼í•˜ê±°ë‚˜ ì§œì¦ì´ ëŠ˜ì—ˆë‹¤', w:2 },
    { id:'tired', label:'ê¸°ìš´ì´ ë¹ ì§€ê³  ë¬´ê¸°ë ¥í•˜ë‹¤', w:2 },
    { id:'cry', label:'ëˆˆë¬¼ì´ ë§ì•„ì¡Œë‹¤', w:2 },
    { id:'alone', label:'í˜¼ì ìˆê³  ì‹¶ê³  ì—°ë½ì´ ë¶€ë‹´ìŠ¤ëŸ½ë‹¤', w:1 },
    { id:'focus', label:'ì§‘ì¤‘ì´ ì˜ ì•ˆ ëœë‹¤', w:1 },
    { id:'anx', label:'ë¶ˆì•ˆì´ ëŠ˜ì—ˆë‹¤', w:2 },
    { id:'body', label:'ëª¸ì´ ë¶“ê±°ë‚˜ ê°€ìŠ´/ë°°ê°€ ë¶ˆí¸í•˜ë‹¤', w:1 }, // PMSì— ìì£¼ ë™ë°˜
  ];

  const NEEDS = [
    'ì˜¤ëŠ˜ì€ ìƒì‚°ì„±(ì„±ê³¼)ì— ëŒ€í•œ ê¸°ëŒ€ë¥¼ ë‚®ì¶°ë„ ê´œì°®ì•„ìš”',
    'ì¤‘ìš”í•œ ê²°ì •/í° ì•½ì†ì€ ê°€ëŠ¥í•œ ë¯¸ë¤„ë„ ë¼ìš”',
    'ìê¸°ë¹„ë‚œ ëŒ€ì‹  â€œì§€ê¸ˆì€ ì»¨ë””ì…˜ì˜ ì˜í–¥â€ì´ë¼ê³  ë§í•´ì£¼ê¸°',
    'í˜¼ì ìˆê³  ì‹¶ìœ¼ë©´ ê·¸ ìš•êµ¬ë¥¼ ì¡´ì¤‘í•´ë„ ê´œì°®ì•„ìš”',
    'ë§ë¡œ ì •ë¦¬í•˜ê¸° í˜ë“¤ë©´, ì¡°ìš©íˆ ì‰¬ì–´ë„ ì¶©ë¶„í•´ìš”'
  ];

  const ACTION_BANK = {
    low: [
      'ë”°ëœ»í•œ ë¬¼/ì°¨ í•œ ì” ë§ˆì‹œê¸°',
      'ì°½ë¬¸ ì—´ê³  í–‡ë¹› 3~5ë¶„ ë°›ê¸°',
      'ê°€ë²¼ìš´ ìŠ¤íŠ¸ë ˆì¹­ 60ì´ˆë§Œ'
    ],
    mid: [
      '10ë¶„ ì‚°ì±… ë˜ëŠ” ê³„ë‹¨ ì²œì²œíˆ ì˜¤ë¥´ê¸°',
      'ì¹´í˜ì¸/ìˆ  ì˜¤ëŠ˜ë§Œ ì¤„ì´ê¸°',
      'ìƒ¤ì›Œ í›„ ë°”ë¡œ ëˆ•ê¸°(í•¸ë“œí°ì€ ì ê¹ ë‚´ë ¤ë‘ê¸°)'
    ],
    high: [
      'ì˜¤ëŠ˜ ì¼ì • 1ê°œë§Œ ì¤„ì´ê¸°(ìµœì†Œ í•˜ë‚˜)',
      'ë”°ëœ»í•œ ìŒì‹/ë‹¨ë°±ì§ˆ ê°„ë‹¨íˆ ì±™ê¸°ê¸°',
      'ì‹ ë¢°í•˜ëŠ” ì‚¬ëŒì—ê²Œ â€œì§€ê¸ˆ ì¢€ í˜ë“¤ì–´â€ í•œ ì¤„ ë³´ë‚´ê¸°'
    ]
  };

  // ìƒíƒœ ê¸°ë°˜ ë¬¸ì¥
  const QUOTES = {
    mood: {
      low: [
        'ì˜¤ëŠ˜ì˜ ë‚˜ëŠ” ê³ ì¥ ë‚œ ê²Œ ì•„ë‹ˆë¼, ì ì‹œ ì§€ì¹œ ìƒíƒœì¼ ë¿ì´ì—ìš”.',
        'ì§€ê¸ˆì˜ ê°ì •ì€ â€œì´ìƒí•¨â€ì´ ì•„ë‹ˆë¼ â€œì‹ í˜¸â€ì¼ ìˆ˜ ìˆì–´ìš”. ì²œì²œíˆ ë‹¤ë¤„ë„ ë¼ìš”.'
      ],
      mid: [
        'ì§€ê¸ˆì€ ë²„í‹°ëŠ” ëŠ¥ë ¥ì´ ì•„ë‹ˆë¼, ë‚˜ë¥¼ ëœ ëª°ì•„ë¶™ì´ëŠ” ëŠ¥ë ¥ì´ í•„ìš”í•œ ë‚ ì´ì—ìš”.',
        'ê´œì°®ì•„ì§€ë ¤ê³  ì• ì“°ëŠ” ê²ƒ ìì²´ê°€ ì´ë¯¸ ì˜í•˜ê³  ìˆëŠ” ê±°ì˜ˆìš”.'
      ],
      high: [
        'ì˜¤ëŠ˜ì€ í¬ê²Œ ì˜í•˜ë ¤ê³  í•˜ì§€ ì•Šì•„ë„ ë¼ìš”. ì‚´ì•„ë‚´ëŠ” ê²ƒë§Œìœ¼ë¡œ ì¶©ë¶„í•´ìš”.',
        'ì§€ê¸ˆì˜ ê°ì •ì´ ì˜¤ë˜ ë¨¸ë¬¼ì§€ ì•Šë„ë¡, ë„ì›€ì„ ë°›ëŠ” ê²ƒë„ ì¢‹ì€ ì„ íƒì´ì—ìš”.'
      ]
    },
    pms: {
      low: [
        'ì´ ì‹œê¸°ëŠ” ëª¸ì˜ ë¦¬ë“¬ ë•Œë¬¸ì— ì˜ˆë¯¼í•´ì§ˆ ìˆ˜ ìˆì–´ìš”. ë„¤ ì˜ëª»ì´ ì•„ë‹ˆì—ìš”.',
        'ì§€ê¸ˆì€ â€œí˜¸ë¥´ëª¬ì˜ ê³„ì ˆâ€ ê°™ì€ ë•Œì˜ˆìš”. ì ê¹ íë¦° ë‚ ì´ë¼ê³  ìƒê°í•´ë„ ë¼ìš”.'
      ],
      mid: [
        'ë°°ë€ í›„~ìƒë¦¬ ì „ì—” ê¸°ë¶„ì„ ì¡ì•„ì£¼ëŠ” ì‹ í˜¸ê°€ ì¤„ì–´ë“¤ ìˆ˜ ìˆì–´ìš”. í”í•œ ì¼ì´ì—ìš”.',
        'ì§€ê¸ˆì€ í•´ê²°ë³´ë‹¤ ì•ˆì •ì´ ë¨¼ì €ì˜ˆìš”. ì˜¤ëŠ˜ì€ ê°€ë³ê²Œë§Œ ê°€ë„ ë¼ìš”.'
      ],
      high: [
        'ì´ ì‹œê¸° ìš°ìš¸ê°ì´ í¬ë©´ PMDDì²˜ëŸ¼ ì¹˜ë£Œê°€ ë„ì›€ì´ ë˜ëŠ” ê²½ìš°ë„ ìˆì–´ìš”. í˜¼ìë§Œì˜ ë¬¸ì œê°€ ì•„ë‹ˆì—ìš”.',
        'ì§€ê¸ˆì˜ ë‚˜ëŠ” ì•½í•œ ê²Œ ì•„ë‹ˆë¼, ëª¸ì´ ì‹ í˜¸ë¥¼ í¬ê²Œ ë³´ë‚´ëŠ” ì¤‘ì¼ ìˆ˜ ìˆì–´ìš”.'
      ]
    }
  };

  const PARTNER_SCRIPT = [
    'â€œì™œ ê·¸ë˜?â€ ëŒ€ì‹  â†’ â€œê·¸ëŸ´ ìˆ˜ ìˆê² ë‹¤. ì§€ê¸ˆ ë§ì´ í˜ë“¤ê² ë‹¤â€',
    'ì¡°ì–¸/í•´ê²°ì±…ë³´ë‹¤ â†’ íŒë‹¨ ì—†ì´ ë“¤ì–´ì£¼ê¸°(â€œì‘â€¦ ê·¸ë¬êµ¬ë‚˜â€)',
    'ì§§ì€ ì²´í¬ì¸: â€œì˜¤ëŠ˜ ì»¨ë””ì…˜ ì–´ë•Œ?â€ â€œë‹µ ëŠ¦ì–´ë„ ê´œì°®ì•„â€',
    'ì˜ˆë¯¼í•¨ì„ ê°œì¸ì ìœ¼ë¡œ ë°›ì•„ë“¤ì´ì§€ ì•Šê¸°(ì‚¬ë‘ì´ ì‹ì–´ì„œê°€ ì•„ë‹˜)',
    'í˜¼ì ìˆê³  ì‹¶ì„ ë• ì¡´ì¤‘í•˜ê¸°: â€œê¸°ë‹¤ë¦´ê²Œ. í•„ìš”í•˜ë©´ ë§í•´ì¤˜â€'
  ];

  // -----------------------------
  // Init
  // -----------------------------
  const symptomChoicesEl = document.getElementById('symptomChoices');
  SYMPTOMS.forEach(s => {
    const label = document.createElement('label');
    label.className = 'choice';
    label.innerHTML = `<input type="checkbox" value="${s.id}" /> <div>${s.label}<small>(${s.w}ì )</small></div>`;
    label.querySelector('input').addEventListener('change', (e)=>{
      if(e.target.checked) state.symptoms.add(s.id);
      else state.symptoms.delete(s.id);
    });
    symptomChoicesEl.appendChild(label);
  });

  refreshSessionInfo();

  // -----------------------------
  // Step navigation
  // -----------------------------
  function startFlow(flow){
    state.flow = flow; // 'mood' | 'pms'
    currentStep = 1;
    renderStep();
  }

  function goBack(){
    if(currentStep === 0) return;
    if(currentStep === 2) currentStep = 1;
    else if(currentStep === 1) currentStep = 0;
    renderStep();
  }

  function toStep2(){
    const g = document.querySelector('input[name="gender"]:checked');
    if(!g){
      alert('ì„±ë³„ ì„ íƒ(ë˜ëŠ” â€œë§í•˜ê³  ì‹¶ì§€ ì•Šì•„ìš”â€)ì„ í•´ì£¼ì„¸ìš”.');
      return;
    }
    state.gender = g.value;

    currentStep = 2;
    renderStep();
  }

  function renderStep(){
    steps.forEach((id,i)=>{
      document.getElementById(id).style.display = (i===currentStep) ? 'block':'none';
    });
    document.getElementById('result').classList.remove('show');

    // ì œëª©/ì§„í–‰
    const titles = ['ì‹œì‘', 'ê¸°ë³¸ ì •ë³´', 'ì»¨ë””ì…˜ ì§ˆë¬¸'];
    document.getElementById('stepH2').textContent = titles[currentStep];
    document.getElementById('progress').textContent = `${Math.min(currentStep,3)} / 3`;

    // PMS ë¸”ë¡ ë…¸ì¶œ ì¡°ê±´:
    // - ì‚¬ìš©ìê°€ flow='pms'ë¡œ ë“¤ì–´ì™”ê±°ë‚˜
    // - ì„±ë³„ì´ ì—¬ì„±ì´ê³ (ë˜ëŠ” ë¯¸ê³µê°œë¼ë„) PMS ì§ˆë¬¸ì„ ë³´ê³  ì‹¶ì–´í•  ìˆ˜ ìˆìœ¼ë‹ˆ flow ê¸°ì¤€ìœ¼ë¡œ í‘œì‹œ
    const showPms = (state.flow === 'pms');
    document.getElementById('pmsBlock').style.display = showPms ? 'block':'none';

    refreshSessionInfo();
  }

  // -----------------------------
  // Scoring & Result
  // -----------------------------
  function showResult(){
    // Read radios
    const cycle = document.querySelector('input[name="cycle"]:checked');
    const sleep = document.querySelector('input[name="sleep"]:checked');
    const crave = document.querySelector('input[name="crave"]:checked');
    state.cycle = cycle ? parseInt(cycle.value,10) : null;
    state.sleep = sleep ? parseInt(sleep.value,10) : 0;
    state.crave = crave ? parseInt(crave.value,10) : 0;

    // Compute score
    let score = 0;
    for(const sid of state.symptoms){
      const item = SYMPTOMS.find(x=>x.id===sid);
      if(item) score += item.w;
    }
    score += state.sleep; // 0~2
    score += state.crave; // 0~2

    // PMS í”Œë¡œìš° ê°€ì¤‘ì¹˜ (ìƒë¦¬ 1ì£¼ ì´ë‚´ +1, 2ì£¼ ì´ë‚´ +0.5 ëŠë‚Œì„ ì ìˆ˜ë¡œ ì²˜ë¦¬)
    if(state.flow === 'pms'){
      if(state.cycle === 7) score += 1;
      if(state.cycle === 14) score += 0;
    }
    state.score = score;

    // Severity thresholds (íŠœë‹ ê°€ëŠ¥)
    // ìµœëŒ€ì¹˜ ëŒ€ëµ: ì¦ìƒ(2*6 +1*2=14) + ìˆ˜ë©´2 + ì‹ìš•2 + pms1 = 19
    if(score <= 6) state.severity = 'low';
    else if(score <= 12) state.severity = 'mid';
    else state.severity = 'high';

    // Build result copy
    const isPms = (state.flow === 'pms');

    // í•´ì„ íƒ€ì´í‹€/ë°”ë””
    const interpretTitle = isPms
      ? 'ì§€ê¸ˆì˜ ìš°ìš¸ê°ì€ â€œë‹¹ì‹  íƒ“â€ì´ ì•„ë‹ˆë¼, ëª¸ì˜ ë¦¬ë“¬ ì˜í–¥ì¼ ê°€ëŠ¥ì„±ì´ ì»¤ìš”.'
      : 'ì§€ê¸ˆì˜ ìš°ìš¸ê°ì€ ì„±ê²© ë¬¸ì œê°€ ì•„ë‹ˆë¼, ì»¨ë””ì…˜ê³¼ ìŠ¤íŠ¸ë ˆìŠ¤ ì‹ í˜¸ì¼ ìˆ˜ ìˆì–´ìš”.';

    const interpretBody = isPms
      ? `ë°°ë€ í›„~ìƒë¦¬ ì „ì—ëŠ” ì—ìŠ¤íŠ¸ë¡œê²/í”„ë¡œê²ŒìŠ¤í…Œë¡  ë³€í™”ë¡œ ê¸°ë¶„ì„ ì¡ì•„ì£¼ëŠ” ì‹ í˜¸(ì„¸ë¡œí† ë‹Œ)ê°€ í”ë“¤ë¦´ ìˆ˜ ìˆì–´ìš”.
ì´ë•ŒëŠ” ì˜ˆë¯¼í•¨, ë¬´ê¸°ë ¥, ëˆˆë¬¼, ë¶ˆì•ˆì´ í•¨ê»˜ ë‚˜íƒ€ë‚˜ê¸°ë„ í•´ìš”.
ì˜¤ëŠ˜ì€ â€œí•´ê²°â€ë³´ë‹¤ â€œì•ˆì •â€ì´ ë¨¼ì €ì¸ ë‚ ë¡œ ì¡ì•„ë„ ê´œì°®ì•„ìš”.`
      : `ìµœê·¼ ë©°ì¹ ì˜ í”¼ë¡œ, ì••ë°•, ìˆ˜ë©´ ë³€í™”ê°€ ê°ì •ì„ ë” í¬ê²Œ ëŠë¼ê²Œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.
ì§€ê¸ˆ í•„ìš”í•œ ê±´ â€œë‚˜ë¥¼ ëª°ì•„ë¶™ì´ëŠ” ë…¼ë¦¬â€ê°€ ì•„ë‹ˆë¼, â€œë‚´ ìƒíƒœë¥¼ ì¸ì •í•˜ëŠ” ë§â€ì¼ ë•Œê°€ ë§ì•„ìš”.
ì˜¤ëŠ˜ì€ ì‘ì€ ë‹¨ìœ„ë¡œë§Œ íšŒë³µí•´ë„ ì¶©ë¶„í•´ìš”.`;

    document.getElementById('interpretTitle').textContent = interpretTitle;
    document.getElementById('interpretBody').textContent = interpretBody;

    // Needs checklist
    const needListEl = document.getElementById('needList');
    needListEl.innerHTML = '';
    NEEDS.forEach((t,idx)=>{
      const row = document.createElement('label');
      row.className = 'needItem';
      row.innerHTML = `<input type="checkbox" data-need="1" /> <div>${t}</div>`;
      row.querySelector('input').addEventListener('change', updateGlow);
      needListEl.appendChild(row);
    });

    // Actions
    const actionsEl = document.getElementById('actionsList');
    actionsEl.innerHTML = '';
    const picks = ACTION_BANK[state.severity].slice(0,3);
    picks.forEach((a)=>{
      const div = document.createElement('div');
      div.className = 'act';
      div.innerHTML = `<span>${a}</span><small style="color:var(--muted)">ì˜¤ëŠ˜ë§Œ</small>`;
      actionsEl.appendChild(div);
    });

    // Support note
    const supportNote = document.getElementById('supportNote');
    supportNote.textContent =
      (state.severity === 'high')
        ? 'â€» í˜ë“¦ì´ í¬ê³  ë°˜ë³µëœë‹¤ë©´, ìƒë‹´/ì§„ë£ŒëŠ” â€œì•½í•¨â€ì´ ì•„ë‹ˆë¼ â€œíšŒë³µ ì†ë„ë¥¼ ë†’ì´ëŠ” ì„ íƒâ€ì¼ ìˆ˜ ìˆì–´ìš”.'
        : 'â€» ì˜¤ëŠ˜ì€ ì¶©ë¶„íˆ ì˜í•˜ê³  ìˆì–´ìš”. ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ê³ , ë‹¹ì‹ ì€ ê·¸ëŒ€ë¡œ ê´œì°®ì•„ìš”.';

    // Partner card: ì—¬ì„±(PMS) íë¦„ì¼ ë•Œ ê¸°ë³¸ ë…¸ì¶œ + ë‚¨ì„±/ë¯¸ê³µê°œë„ ë³¼ ìˆ˜ ìˆê²Œ
    document.getElementById('cardPartner').style.display = (isPms ? 'block' : 'none');
    document.getElementById('partnerText').innerHTML = `
      <ul style="margin:10px 0 0; padding-left:18px; color:var(--muted); line-height:1.7">
        ${PARTNER_SCRIPT.map(x=>`<li>${x}</li>`).join('')}
      </ul>
      <div style="margin-top:10px; color:var(--muted)">
        ì¶”ì²œ ë¬¸ì¥: â€œì§€ê¸ˆì€ ë„¤ ì˜ëª» ì•„ë‹ˆì•¼â€ Â· â€œë§ ì—†ì–´ë„ ê´œì°®ì•„â€ Â· â€œë‚´ê°€ ì—¬ê¸° ìˆì–´â€
      </div>
    `;

    // Show result
    document.getElementById('result').classList.add('show');
    // ì´ˆê¸° ë¬¸ì¥ ìë™ ìƒì„± (UX)
    genQuote();

    // top scroll to result
    document.getElementById('mainCard').scrollIntoView({behavior:'smooth', block:'start'});
  }

  function updateGlow(){
    // needs ì²´í¬ ê°œìˆ˜ì— ë”°ë¼ ì¹´ë“œ ë°°ê²½ì„ ë°ê²Œ
    const checked = document.querySelectorAll('input[data-need="1"]:checked').length;
    const level = Math.min(3, checked);

    const ids = ['cardInterpret','cardNeeds','cardActions','cardQuote','cardPartner'];
    ids.forEach(id=>{
      const el = document.getElementById(id);
      if(!el) return;
      el.classList.remove('glow0','glow1','glow2','glow3');
      el.classList.add(`glow${level}`);
    });
  }

  // -----------------------------
  // Quote generator & copy
  // -----------------------------
  function genQuote(){
    const bank = QUOTES[state.flow || 'mood'][state.severity || 'low'];
    const q = bank[Math.floor(Math.random()*bank.length)];
    document.getElementById('quoteText').textContent = q;
  }

  async function copyQuote(){
    const text = document.getElementById('quoteText').textContent.trim();
    if(!text) return;
    try{
      await navigator.clipboard.writeText(text);
      toast('ë³µì‚¬í–ˆì–´ìš”!');
    }catch(e){
      prompt('ì•„ë˜ ë¬¸ì¥ì„ ë³µì‚¬í•˜ì„¸ìš”:', text);
    }
  }

  async function copyPartner(){
    const lines = [
      'ì£¼ë³€ì¸ì—ê²Œ ë¶€íƒí•˜ê³  ì‹¶ì€ ë°©ì‹',
      ...PARTNER_SCRIPT.map(s=>`- ${s}`),
      '- ì¶”ì²œ ë¬¸ì¥: â€œì§€ê¸ˆì€ ë„¤ ì˜ëª» ì•„ë‹ˆì•¼â€ / â€œë§ ì—†ì–´ë„ ê´œì°®ì•„â€ / â€œë‚´ê°€ ì—¬ê¸° ìˆì–´â€'
    ].join('\n');
    try{
      await navigator.clipboard.writeText(lines);
      toast('ë³µì‚¬í–ˆì–´ìš”!');
    }catch(e){
      prompt('ì•„ë˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ì„¸ìš”:', lines);
    }
  }

  function restart(){
    // reset
    state.flow = null;
    state.gender = null;
    state.symptoms = new Set();
    state.cycle = null;
    state.sleep = null;
    state.crave = null;
    state.score = 0;
    state.severity = 'low';

    // reset inputs
    document.querySelectorAll('input').forEach(i=>{
      if(i.type==='checkbox' || i.type==='radio') i.checked = false;
    });

    currentStep = 0;
    renderStep();
    toast('ì²˜ìŒìœ¼ë¡œ ëŒì•„ì™”ì–´ìš”.');
  }

  function refreshSessionInfo(){
    const info = [];
    if(state.flow) info.push(state.flow==='pms' ? 'PMS íë¦„' : 'ì¼ë°˜ íë¦„');
    if(state.gender){
      const g = {female:'ì—¬ì„±', male:'ë‚¨ì„±', na:'ë¹„ê³µê°œ'}[state.gender];
      info.push(g);
    }
    document.getElementById('sessionInfo').textContent = info.length ? `ì„¸ì…˜: ${info.join(' Â· ')}` : 'ì„¸ì…˜: ì‹œì‘ ì „';
  }

  // tiny toast
  let tmr = null;
  function toast(msg){
    let el = document.getElementById('toast');
    if(!el){
      el = document.createElement('div');
      el.id = 'toast';
      el.style.position = 'fixed';
      el.style.left = '50%';
      el.style.bottom = '20px';
      el.style.transform = 'translateX(-50%)';
      el.style.padding = '10px 14px';
      el.style.border = '1px solid rgba(255,255,255,.6)';
      el.style.background = 'rgba(30,30,40,.75)';
      el.style.color = 'white';
      el.style.borderRadius = '999px';
      el.style.backdropFilter = 'blur(10px)';
      el.style.boxShadow = '0 12px 40px rgba(0,0,0,.18)';
      el.style.fontSize = '13px';
      el.style.zIndex = '9999';
      el.style.opacity = '0';
      el.style.transition = 'opacity .15s ease';
      document.body.appendChild(el);
    }
    el.textContent = msg;
    el.style.opacity = '1';
    clearTimeout(tmr);
    tmr = setTimeout(()=>{ el.style.opacity='0'; }, 1200);
  }

  // Initial render
  renderStep();
</script>
</body>
</html>
